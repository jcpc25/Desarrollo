<?xml version="1.0" encoding="utf-8" ?>
<Sqls>


  <Sql>
    <key>Save</key>
    <query>
       insert into eve_mantto(
           manttocodi,
           equicodi,
           evenclasecodi,
           tipoevencodi,
           compcode,
           evenini,
           evenpreini,
           evenfin,
           subcausacodi,
           evenprefin,
           evenmwindisp,
           evenpadre,
           evenindispo,
           eveninterrup,
           eventipoprog,
           evendescrip,
           evenobsrv,
           evenestado,
           lastuser,
           lastdate,
           evenrelevante,
           deleted,
           mancodi,
           manttocodi,
           equicodi,
           evenclasecodi,
           tipoevencodi,
           compcode,
           evenini,
           evenpreini,
           evenfin,
           subcausacodi,
           evenprefin,
           evenmwindisp,
           evenpadre,
           evenindispo,
           eveninterrup,
           eventipoprog,
           evendescrip,
           evenobsrv,
           evenestado,
           lastuser,
           lastdate,
           evenrelevante,
           deleted,
           mancodi
       )
       values(
           :manttocodi,
           :equicodi,
           :evenclasecodi,
           :tipoevencodi,
           :compcode,
           :evenini,
           :evenpreini,
           :evenfin,
           :subcausacodi,
           :evenprefin,
           :evenmwindisp,
           :evenpadre,
           :evenindispo,
           :eveninterrup,
           :eventipoprog,
           :evendescrip,
           :evenobsrv,
           :evenestado,
           :lastuser,
           :lastdate,
           :evenrelevante,
           :deleted,
           :mancodi,
           :manttocodi,
           :equicodi,
           :evenclasecodi,
           :tipoevencodi,
           :compcode,
           :evenini,
           :evenpreini,
           :evenfin,
           :subcausacodi,
           :evenprefin,
           :evenmwindisp,
           :evenpadre,
           :evenindispo,
           :eveninterrup,
           :eventipoprog,
           :evendescrip,
           :evenobsrv,
           :evenestado,
           :lastuser,
           :lastdate,
           :evenrelevante,
           :deleted,
           :mancodi
       )
    </query>
  </Sql>

  <Sql>
    <key>Update</key>
    <query>
       update eve_mantto
       set
           equicodi = :equicodi,
           evenclasecodi = :evenclasecodi,
           tipoevencodi = :tipoevencodi,
           compcode = :compcode,
           evenini = :evenini,
           evenpreini = :evenpreini,
           evenfin = :evenfin,
           subcausacodi = :subcausacodi,
           evenprefin = :evenprefin,
           evenmwindisp = :evenmwindisp,
           evenpadre = :evenpadre,
           evenindispo = :evenindispo,
           eveninterrup = :eveninterrup,
           eventipoprog = :eventipoprog,
           evendescrip = :evendescrip,
           evenobsrv = :evenobsrv,
           evenestado = :evenestado,
           lastuser = :lastuser,
           lastdate = :lastdate,
           evenrelevante = :evenrelevante,
           deleted = :deleted,
           mancodi = :mancodi,
           equicodi = :equicodi,
           evenclasecodi = :evenclasecodi,
           tipoevencodi = :tipoevencodi,
           compcode = :compcode,
           evenini = :evenini,
           evenpreini = :evenpreini,
           evenfin = :evenfin,
           subcausacodi = :subcausacodi,
           evenprefin = :evenprefin,
           evenmwindisp = :evenmwindisp,
           evenpadre = :evenpadre,
           evenindispo = :evenindispo,
           eveninterrup = :eveninterrup,
           eventipoprog = :eventipoprog,
           evendescrip = :evendescrip,
           evenobsrv = :evenobsrv,
           evenestado = :evenestado,
           lastuser = :lastuser,
           lastdate = :lastdate,
           evenrelevante = :evenrelevante,
           deleted = :deleted,
           mancodi = :mancodi
       where
           manttocodi = :manttocodi and
           manttocodi = :manttocodi
    </query>
  </Sql>

  <Sql>
    <key>Delete</key>
    <query>
       delete from eve_mantto
       where
           manttocodi = :manttocodi and
           manttocodi = :manttocodi
    </query>
  </Sql>

  <Sql>
    <key>GetById</key>
    <query>
       select
           manttocodi,
           equicodi,
           evenclasecodi,
           tipoevencodi,
           compcode,
           evenini,
           evenpreini,
           evenfin,
           subcausacodi,
           evenprefin,
           evenmwindisp,
           evenpadre,
           evenindispo,
           eveninterrup,
           eventipoprog,
           evendescrip,
           evenobsrv,
           evenestado,
           lastuser,
           lastdate,
           evenrelevante,
           deleted,
           mancodi,
           manttocodi,
           equicodi,
           evenclasecodi,
           tipoevencodi,
           compcode,
           evenini,
           evenpreini,
           evenfin,
           subcausacodi,
           evenprefin,
           evenmwindisp,
           evenpadre,
           evenindispo,
           eveninterrup,
           eventipoprog,
           evendescrip,
           evenobsrv,
           evenestado,
           lastuser,
           lastdate,
           evenrelevante,
           deleted,
           mancodi
       where
           manttocodi = :manttocodi and
           manttocodi = :manttocodi
       from
           eve_mantto
    </query>
  </Sql>

  <Sql>
    <key>List</key>
    <query>
       select
           manttocodi,
           equicodi,
           evenclasecodi,
           tipoevencodi,
           compcode,
           evenini,
           evenpreini,
           evenfin,
           subcausacodi,
           evenprefin,
           evenmwindisp,
           evenpadre,
           evenindispo,
           eveninterrup,
           eventipoprog,
           evendescrip,
           evenobsrv,
           evenestado,
           lastuser,
           lastdate,
           evenrelevante,
           deleted,
           mancodi,
           manttocodi,
           equicodi,
           evenclasecodi,
           tipoevencodi,
           compcode,
           evenini,
           evenpreini,
           evenfin,
           subcausacodi,
           evenprefin,
           evenmwindisp,
           evenpadre,
           evenindispo,
           eveninterrup,
           eventipoprog,
           evendescrip,
           evenobsrv,
           evenestado,
           lastuser,
           lastdate,
           evenrelevante,
           deleted,
           mancodi
       from
           eve_mantto
    </query>
  </Sql>

  <Sql>
    <key>GetByCriteria</key>
    <query>
      select *
      from (
      select
      eq.equiabrev,
      mant.manttocodi,
      mant.equicodi,
      mant.evenclasecodi,
      mant.tipoevencodi,
      mant.compcode,
      mant.evenini,
      mant.evenpreini,
      mant.evenfin,
      mant.subcausacodi,
      mant.evenprefin,
      mant.evenmwindisp,
      mant.evenpadre,
      mant.evenindispo,
      mant.eventipoprog,
      mant.evendescrip,
      mant.evenobsrv,
      mant.evenestado,
      mant.lastuser,
      mant.lastdate,
      mant.evenrelevante,
      mant.deleted,
      mant.mancodi,
      subcausa.subcausaabrev,
      eq.famcodi,
      emp.emprcodi,
      eq.areacodi,
      eq.equitension,
      ar.areanomb,
      f.famabrev,
      f.famnomb,
      emp.emprnomb,
      emp.emprabrev,
      cla.evenclasedesc,
      causa.Causaevenabrev,
      tipo_empresa.tipoemprdesc,
      TIPOEVE.TIPOEVENABREV,
      TIPOEVE.TIPOEVENDESC,
      case f.tipoecodi when 2 then 'G' else 'T' end osigrupocodi,
      case MANT.eveninterrup when 'S' then 'SI' else 'NO' end eveninterrup,
      (row_number() over (order by MANT.MANTTOCODI)) as r
      from
      eve_mantto mant
      INNER JOIN EVE_TIPOEVENTO TIPOEVE ON TIPOEVE.TIPOEVENCODI = MANT.TIPOEVENCODI
      INNER JOIN EVE_EVENCLASE CLA ON CLA.EVENCLASECODI = MANT.EVENCLASECODI
      inner join eve_subcausaevento subcausa on mant.subcausacodi = subcausa.subcausacodi
      inner join eve_causaevento causa on subcausa.causaevencodi = causa.causaevencodi
      INNER JOIN EQ_EQUIPO EQ ON EQ.EQUICODI = mant.EQUICODI
      INNER JOIN EQ_AREA AR ON AR.AREACODI = EQ.AREACODI
      INNER JOIN EQ_FAMILIA F ON F.FAMCODI = EQ.FAMCODI
      INNER JOIN SI_EMPRESA EMP ON EMP.EMPRCODI = EQ.EMPRCODI
      inner join si_tipoempresa tipo_empresa on emp.tipoemprcodi = tipo_empresa.tipoemprcodi
      where
      (mant.EVENCLASECODI in ({0}) or '{0}' = '-1') and
      (TIPOEVE.TIPOEVENCODI in ({9}) or '{9}' = '-1') and
      (EQ.EQUICODI in ({10}) or '{10}' = '-1') and
      (emp.emprcodi in ({1}) or '{1}' = '-1') and
      (tipo_empresa.tipoemprcodi in ({7}) or '{7}' = '-1') and
      (f.famcodi in ({2}) or '{2}' = '-1') and
      (mant.eveninterrup = '{8}' or '{8}' = '-1') and
      (( evenini >=  TO_DATE('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')  and evenini &lt;  TO_DATE('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')
         and evenfin >  TO_DATE('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')
      ))
      order by emp.emprnomb asc
      )
      where r >= ((({5}-1) * {6}) + 1) and r &lt; (({6} * {5}) + 1 )
    </query>
  </Sql>

  <Sql>
    <key>TotalRecords</key>
    <query>
      select
      count(*)
      from eve_mantto mantto
      inner join eq_equipo equipo on mantto.equicodi = equipo.equicodi
      inner join eq_familia familia on equipo.famcodi = familia.famcodi
      inner join eve_subcausaevento subcausa on mantto.subcausacodi = subcausa.subcausacodi
      INNER JOIN EVE_TIPOEVENTO TIPOEVE ON TIPOEVE.TIPOEVENCODI = MANTto.TIPOEVENCODI
      inner join EVE_EVENCLASE clase on mantto.EVENCLASECODI = clase.EVENCLASECODI
      inner join si_empresa empresa on equipo.emprcodi = empresa.emprcodi
      inner join si_tipoempresa tipo_empresa on empresa.tipoemprcodi = tipo_empresa.tipoemprcodi
      inner join eq_area area on equipo.areacodi = area.areacodi
      inner join eve_causaevento causa on subcausa.causaevencodi = causa.causaevencodi
      where (mantto.EVENCLASECODI in ({0}) or '{0}' = '-1') and
      (TIPOEVE.TIPOEVENCODI in ({7}) or '{7}' = '-1') and
      (equipo.EQUICODI in ({8}) or '{8}' = '-1') and
      (empresa.emprcodi in ({1}) or '{1}' = '-1') and
      (tipo_empresa.tipoemprcodi in ({5}) or '{5}' = '-1') and
      (familia.famcodi in ({2}) or '{2}' = '-1') and
      (mantto.eveninterrup = '{6}' or '{6}' = '-1') and
      (( evenini >=  TO_DATE('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')  and evenini &lt;  TO_DATE('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')  ) or
      ( evenfin >  TO_DATE('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')  and evenfin &lt;=  TO_DATE('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')  ) or
      ( evenini &lt;  TO_DATE('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')  and evenfin >  TO_DATE('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')  ))
     
    </query>

  </Sql>
  
  <Sql>
    <key>MantEmpresas</key>
    <query>
      select
      emp.emprcodi,
      emp.emprnomb,
      count(manttocodi) totalmantto
      from
      eve_mantto mant
      INNER JOIN EVE_EVENCLASE CLA ON CLA.EVENCLASECODI = MANT.EVENCLASECODI
      inner join eve_subcausaevento subcausa on mant.subcausacodi = subcausa.subcausacodi
      inner join eve_causaevento causa on subcausa.causaevencodi = causa.causaevencodi
      INNER JOIN EVE_TIPOEVENTO TIPOEVE ON TIPOEVE.TIPOEVENCODI = MANT.TIPOEVENCODI
      INNER JOIN EQ_EQUIPO EQ ON EQ.EQUICODI = mant.EQUICODI
      INNER JOIN EQ_AREA AR ON AR.AREACODI = EQ.AREACODI
      INNER JOIN EQ_FAMILIA F ON F.FAMCODI = EQ.FAMCODI
      INNER JOIN SI_EMPRESA EMP ON EMP.EMPRCODI = EQ.EMPRCODI
      inner join si_tipoempresa tipo_empresa on emp.tipoemprcodi = tipo_empresa.tipoemprcodi
      where
      (mant.EVENCLASECODI = 1) and
      (TIPOEVE.TIPOEVENCODI in ({6}) or '{6}' = '-1') and
      (emp.emprcodi in ({0}) or '{0}' = '-1') and
      (tipo_empresa.tipoemprcodi in '{1}' or '{1}' = '-1') and
      (f.famcodi in '{2}' or '{2}' = '-1') and
      (mant.eveninterrup = '{3}' or '{3}' = '-1') and
      (( evenini >=  TO_DATE('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')  and evenini &lt;  TO_DATE('{5} 00:00:00','YYYY-MM-DD HH24:MI:SS')
         and evenfin >  TO_DATE('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')
      ))
      group by emp.emprcodi,emp.emprnomb
      order by emp.emprnomb asc     
    </query>
  </Sql>

  <Sql>
    <key>ReporteMantto</key>
    <query>
      select
      eq.equiabrev,
      mant.manttocodi,
      mant.equicodi,
      mant.evenclasecodi,
      mant.tipoevencodi,
      mant.compcode,
      mant.evenini,
      mant.evenpreini,
      mant.evenfin,
      mant.subcausacodi,
      mant.evenprefin,
      mant.evenmwindisp,
      mant.eveninterrup,
      mant.evenpadre,
      mant.evenindispo,
      mant.eventipoprog,
      mant.evendescrip,
      mant.evenobsrv,
      mant.evenestado,
      mant.lastuser,
      mant.lastdate,
      evenrelevante,
      mant.deleted,
      mant.mancodi,
      subcausa.subcausaabrev,
      eq.famcodi,
      eq.areacodi,
      eq.equitension,
      ar.areanomb,
      f.famabrev,
      f.famnomb,
      emp.emprnomb,
      emp.emprabrev,
      emp.emprcodi,
      cla.evenclasedesc,
      causa.Causaevenabrev,
      TIPOEVE.TIPOEVENABREV,
      TIPOEVE.TIPOEVENDESC,
      case f.tipoecodi when 2 then 'G' else 'T' end osigrupocodi,
      case MANT.eveninterrup when 'S' then 'SI' else 'NO' end eveninterrup,
      tipo_empresa.tipoemprdesc
      from
      eve_mantto mant
      INNER JOIN EVE_TIPOEVENTO TIPOEVE ON TIPOEVE.TIPOEVENCODI = MANT.TIPOEVENCODI
      INNER JOIN EVE_EVENCLASE CLA ON CLA.EVENCLASECODI = MANT.EVENCLASECODI
      inner join eve_subcausaevento subcausa on mant.subcausacodi = subcausa.subcausacodi
      inner join eve_causaevento causa on subcausa.causaevencodi = causa.causaevencodi
      INNER JOIN EQ_EQUIPO EQ ON EQ.EQUICODI = mant.EQUICODI
      INNER JOIN EQ_AREA AR ON AR.AREACODI = EQ.AREACODI
      INNER JOIN EQ_FAMILIA F ON F.FAMCODI = EQ.FAMCODI
      INNER JOIN SI_EMPRESA EMP ON EMP.EMPRCODI = EQ.EMPRCODI
      inner join si_tipoempresa tipo_empresa on emp.tipoemprcodi = tipo_empresa.tipoemprcodi
      where
      (mant.EVENCLASECODI in ({0}) or '{0}' = '-1') and
      (TIPOEVE.TIPOEVENCODI in ({7}) or '{7}' = '-1') and
      (EQ.EQUICODI in ({8}) or '{8}' = '-1') and
      (emp.emprcodi in ({1}) or '{1}' = '-1') and
      (tipo_empresa.tipoemprcodi in ({5}) or '{5}' = '-1') and
      (f.famcodi in ({2}) or '{2}' = '-1') and

      (mant.eveninterrup = '{6}' or '{6}' = '-1') and
      (( evenini >=  TO_DATE('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')  and evenini &lt;  TO_DATE('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')
      and evenfin >  TO_DATE('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')
      ))

      order by emp.emprnomb asc

    </query>
  </Sql>
      
</Sqls>
