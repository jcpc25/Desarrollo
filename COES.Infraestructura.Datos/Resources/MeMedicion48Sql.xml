<?xml version="1.0" encoding="utf-8" ?>
<Sqls>


  <Sql>
    <key>Save</key>
    <query>
      insert into me_medicion48(
      lastuser,
      lastdate,
      lectcodi,
      medifecha,
      tipoinfocodi,
      ptomedicodi,
      h1,
      meditotal,
      mediestado,
      h2,
      h3,
      h4,
      h5,
      h6,
      h7,
      h8,
      h9,
      h10,
      h11,
      h12,
      h13,
      h14,
      h15,
      h16,
      h17,
      h18,
      h19,
      h20,
      h21,
      h22,
      h23,
      h24,
      h25,
      h26,
      h27,
      h28,
      h29,
      h30,
      h31,
      h32,
      h33,
      h34,
      h35,
      h36,
      h37,
      h38,
      h39,
      h40,
      h41,
      h42,
      h43,
      h44,
      h45,
      h46,
      h47,
      h48
      )
      values(
      :lastuser,
      :lastdate,
      :lectcodi,
      :medifecha,
      :tipoinfocodi,
      :ptomedicodi,
      :h1,
      :meditotal,
      :mediestado,
      :h2,
      :h3,
      :h4,
      :h5,
      :h6,
      :h7,
      :h8,
      :h9,
      :h10,
      :h11,
      :h12,
      :h13,
      :h14,
      :h15,
      :h16,
      :h17,
      :h18,
      :h19,
      :h20,
      :h21,
      :h22,
      :h23,
      :h24,
      :h25,
      :h26,
      :h27,
      :h28,
      :h29,
      :h30,
      :h31,
      :h32,
      :h33,
      :h34,
      :h35,
      :h36,
      :h37,
      :h38,
      :h39,
      :h40,
      :h41,
      :h42,
      :h43,
      :h44,
      :h45,
      :h46,
      :h47,
      :h48
      )
    </query>
  </Sql>

  <Sql>
    <key>Update</key>
    <query>
      update me_medicion48
      set
      lastuser = :lastuser,
      lastdate = :lastdate,
      h1 = :h1,
      meditotal = :meditotal,
      mediestado = :mediestado,
      h2 = :h2,
      h3 = :h3,
      h4 = :h4,
      h5 = :h5,
      h6 = :h6,
      h7 = :h7,
      h8 = :h8,
      h9 = :h9,
      h10 = :h10,
      h11 = :h11,
      h12 = :h12,
      h13 = :h13,
      h14 = :h14,
      h15 = :h15,
      h16 = :h16,
      h17 = :h17,
      h18 = :h18,
      h19 = :h19,
      h20 = :h20,
      h21 = :h21,
      h22 = :h22,
      h23 = :h23,
      h24 = :h24,
      h25 = :h25,
      h26 = :h26,
      h27 = :h27,
      h28 = :h28,
      h29 = :h29,
      h30 = :h30,
      h31 = :h31,
      h32 = :h32,
      h33 = :h33,
      h34 = :h34,
      h35 = :h35,
      h36 = :h36,
      h37 = :h37,
      h38 = :h38,
      h39 = :h39,
      h40 = :h40,
      h41 = :h41,
      h42 = :h42,
      h43 = :h43,
      h44 = :h44,
      h45 = :h45,
      h46 = :h46,
      h47 = :h47,
      h48 = :h48
      where
      lectcodi = :lectcodi and
      medifecha = :medifecha and
      tipoinfocodi = :tipoinfocodi and
      ptomedicodi = :ptomedicodi
    </query>
  </Sql>

  <Sql>
    <key>Delete</key>
    <query>
      delete from me_medicion48
      where
      lectcodi = :lectcodi and
      medifecha = :medifecha and
      tipoinfocodi = :tipoinfocodi and
      ptomedicodi = :ptomedicodi
    </query>
  </Sql>

  <Sql>
    <key>GetById</key>
    <query>
      select
      lastuser,
      lastdate,
      lectcodi,
      medifecha,
      tipoinfocodi,
      ptomedicodi,
      h1,
      meditotal,
      mediestado,
      h2,
      h3,
      h4,
      h5,
      h6,
      h7,
      h8,
      h9,
      h10,
      h11,
      h12,
      h13,
      h14,
      h15,
      h16,
      h17,
      h18,
      h19,
      h20,
      h21,
      h22,
      h23,
      h24,
      h25,
      h26,
      h27,
      h28,
      h29,
      h30,
      h31,
      h32,
      h33,
      h34,
      h35,
      h36,
      h37,
      h38,
      h39,
      h40,
      h41,
      h42,
      h43,
      h44,
      h45,
      h46,
      h47,
      h48
      where
      lectcodi = :lectcodi and
      medifecha = :medifecha and
      tipoinfocodi = :tipoinfocodi and
      ptomedicodi = :ptomedicodi
      from
      me_medicion48
    </query>
  </Sql>

  <Sql>
    <key>List</key>
    <query>
      select
      lastuser,
      lastdate,
      lectcodi,
      medifecha,
      tipoinfocodi,
      ptomedicodi,
      h1,
      meditotal,
      mediestado,
      h2,
      h3,
      h4,
      h5,
      h6,
      h7,
      h8,
      h9,
      h10,
      h11,
      h12,
      h13,
      h14,
      h15,
      h16,
      h17,
      h18,
      h19,
      h20,
      h21,
      h22,
      h23,
      h24,
      h25,
      h26,
      h27,
      h28,
      h29,
      h30,
      h31,
      h32,
      h33,
      h34,
      h35,
      h36,
      h37,
      h38,
      h39,
      h40,
      h41,
      h42,
      h43,
      h44,
      h45,
      h46,
      h47,
      h48
      from
      me_medicion48
    </query>
  </Sql>

  <Sql>
    <key>GetHidrologia</key>
    <query>
      select
      m48.*, tpto.tipoptomedinomb,eq.equinomb,ti.tipoinfoabrev,pto.ptomedibarranomb
      from
      me_medicion48 m48
      inner join me_ptomedicion pto on pto.ptomedicodi = m48.ptomedicodi
      inner join eq_equipo eq on eq.equicodi = pto.equicodi
      inner join me_tipoptomedicion tpto on tpto.tipoptomedicodi = pto.tipoptomedicodi
      inner join si_tipoinformacion ti on ti.tipoinfocodi = m48.tipoinfocodi
      inner join si_empresa empr on empr.emprcodi = eq.emprcodi
      where m48.lectcodi = {0} and pto.origlectcodi ={1} and
      (empr.emprcodi in ({2}) or '{2}' = '-1') and
      (eq.equipadre in ({5}) or '{5}' = '-1') and
      m48.medifecha >= to_date('{3}','YYYY-MM-DD') AND
      m48.medifecha &lt;= to_date('{4}','YYYY-MM-DD') 
    </query>
  </Sql>

  <Sql>
    <key>DeleteEnvioArchivo</key>
    <query>
      delete from me_medicion48 where lectcodi = {0} and medifecha >= to_date('{1}','YYYY-MM-DD') and
      medifecha &lt;= to_date('{2}','YYYY-MM-DD') and ptomedicodi in (
      select distinct hp.ptomedicodi from me_hojaptomed hp
      inner join me_ptomedicion pto on pto.ptomedicodi = hp.ptomedicodi
      where hp.formatcodi = {3} and pto.emprcodi = {4}
      )
    </query>
  </Sql>
  
  <Sql>
    <key>GetGeneracionRER</key>
    <query>
      select * from me_medicion48
      where lectcodi = {0}
      and (medifecha >= to_date('{1}','yyyy-MM-dd') and medifecha &lt;= to_date('{2}','yyyy-MM-dd'))
      and ptomedicodi in (
      select
      rer.ptomedicodi
      from
      wb_generacionrer rer
      inner join me_ptomedicion pto on rer.ptomedicodi = pto.ptomedicodi
      where (pto.emprcodi = {3} or {3} = 0) and rer.estado = 'A')
      order by medifecha asc
    </query>
  </Sql>

  <Sql>
    <key>EliminarGeneracionRER</key>
    <query>
      delete from me_medicion48
      where lectcodi = {0}
      and (medifecha >= to_date('{1}','yyyy-MM-dd') and medifecha &lt;= to_date('{2}','yyyy-MM-dd'))
      and ptomedicodi in (
      select
      rer.ptomedicodi
      from
      wb_generacionrer rer
      inner join me_ptomedicion pto on rer.ptomedicodi = pto.ptomedicodi
      where pto.emprcodi = {3} and rer.estado = 'A')
    </query>
  </Sql>

  <Sql>
    <key>ValidarExistenciaRER</key>
    <query>
      select count(*) as contador from me_medicion48
      where lectcodi = {0}
      and (medifecha >= to_date('{1}','yyyy-MM-dd') and medifecha &lt;= to_date('{2}','yyyy-MM-dd'))
      and ptomedicodi in (
      select
      rer.ptomedicodi
      from
      wb_generacionrer rer
      inner join me_ptomedicion pto on rer.ptomedicodi = pto.ptomedicodi
      where pto.emprcodi = {3} and rer.estado = 'A')
    </query>
  </Sql>

  <Sql>
    <key>GetEnvioArchivo</key>
    <query>
      select me.* from me_medicion48 me
      inner join me_hojaptomed hp on hp.ptomedicodi = me.ptomedicodi and hp.tipoinfocodi = me.tipoinfocodi
      inner join me_formatohoja fh on fh.formatcodi = hp.formatcodi
      inner join me_ptomedicion pto on pto.ptomedicodi = hp.ptomedicodi
      where hp.formatcodi = {0} and pto.emprcodi = {1} and medifecha >= to_date('{2}','YYYY-MM-DD') AND
      medifecha &lt;= to_date('{3}','YYYY-MM-DD')
      order by hp.hojaptoorden asc
    </query>
  </Sql>  
  
</Sqls>
