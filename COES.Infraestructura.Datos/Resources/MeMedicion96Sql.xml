<?xml version="1.0" encoding="utf-8" ?>
<Sqls>

  <Sql>
    <key>Save</key>
    <query>
      insert into me_medicion96(
      h96,h95,h94, h93,h92,h91,h90,h89,h88,h87,h86,h85,h84,h83,h82,h81,h80,h79,h78,h77,h76,h75,h74,h73,h72,h71,h70,
      h69,h68,h67,h66,h65,h64,h63,h62,h61,h60,h59,h58,h57,h56,h55,h54,h53,h52,h51,h50,h49,h48,h47,h46,h45,h44,h43,h42,h41,h40,
      h39,h38,h37,h36,h35,h34,h33,h32,h31,h30,h29,h28,h27,h26,h25,h24,h23,h22,h21,h20,h19,h18,h17,h16,h15,h14,h13, h12,h11,h10,
      h9,h8,h7,h6,h5,h4,h3,h2,h1,mediestado,meditotal,ptomedicodi,tipoinfocodi,medifecha,lectcodi
      )
      values(
      :h96,
      :h95,
      :h94,
      :h93,
      :h92,
      :h91,
      :h90,
      :h89,
      :h88,
      :h87,
      :h86,
      :h85,
      :h84,
      :h83,
      :h82,
      :h81,
      :h80,
      :h79,
      :h78,
      :h77,
      :h76,
      :h75,
      :h74,
      :h73,
      :h72,
      :h71,
      :h70,
      :h69,
      :h68,
      :h67,
      :h66,
      :h65,
      :h64,
      :h63,
      :h62,
      :h61,
      :h60,
      :h59,
      :h58,
      :h57,
      :h56,
      :h55,
      :h54,
      :h53,
      :h52,
      :h51,
      :h50,
      :h49,
      :h48,
      :h47,
      :h46,
      :h45,
      :h44,
      :h43,
      :h42,
      :h41,
      :h40,
      :h39,
      :h38,
      :h37,
      :h36,
      :h35,
      :h34,
      :h33,
      :h32,
      :h31,
      :h30,
      :h29,
      :h28,
      :h27,
      :h26,
      :h25,
      :h24,
      :h23,
      :h22,
      :h21,
      :h20,
      :h19,
      :h18,
      :h17,
      :h16,
      :h15,
      :h14,
      :h13,
      :h12,
      :h11,
      :h10,
      :h9,
      :h8,
      :h7,
      :h6,
      :h5,
      :h4,
      :h3,
      :h2,
      :h1,
      :mediestado,
      :meditotal,
      :ptomedicodi,
      :tipoinfocodi,
      :medifecha,
      :lectcodi
      )
    </query>
  </Sql>

  <Sql>
    <key>Delete</key>
    <query>
      delete from me_medicion96
      where
      ptomedicodi = :ptomedicodi and
      tipoinfocodi = :tipoinfocodi and
      medifecha = :medifecha and
      lectcodi = :lectcodi and
    </query>
  </Sql>

  <Sql>
    <key>GetByCriteria</key>
    <query>
      select
      me.*
      from
      me_medicion96 me
      where
      me.tipoinfocodi = {0} and ptomedicodi = {1} and lectcodi = {2} and me.medifecha >=to_date('{3}','YYYY-MM-DD')
      and me.medifecha &lt;= to_date('{4}','YYYY-MM-DD')
    </query>
  </Sql>

  <Sql>
    <key>ObtenerEnvioPorEmpresa</key>
    <query>
      select me.*
      from me_medicion96 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      where
      me.tipoinfocodi in (1,2)
      and me.lectcodi = 1
      and pto.origlectcodi in (1,14)
      and eq.emprcodi = {0}
      and EXTRACT(YEAR FROM MEDIFECHA) = {1}
      and EXTRACT(MONTH FROM MEDIFECHA) = {2}
      order by me.medifecha asc
    </query>
  </Sql>
  <Sql>
    <key>ObtenerEnvioInterconexion</key>
    <query>
      select me.*,eq.equinomb
      from me_medicion96 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      where
      me.tipoinfocodi in (3,4,5,9)
      and me.lectcodi = 1
      and pto.origlectcodi = 7
      and eq.emprcodi = {0}
      AND me.MEDIFECHA = to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')
      order by me.medifecha asc
    </query>
  </Sql>

  <Sql>
    <key>ObtenerHistoricoInterconexion</key>
    <query>
      select me.*,eq.equinomb
      from me_medicion96 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      where
      me.tipoinfocodi in (3,4,5,9)
      and me.lectcodi = 1
      and pto.ptomedicodi = {0}
      AND me.MEDIFECHA >= to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS') 
      AND me.MEDIFECHA &lt;= to_date('{2} 00:00:00','YYYY-MM-DD HH24:MI:SS')
      order by me.medifecha asc
    </query>
  </Sql>

  <Sql>
    <key>HistoricoPagInterconexion</key>
    <query>
      select * from (
      select
      me.*,
      (row_number() over (order by me.medifecha)) as r
      from me_medicion96 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      where
      me.tipoinfocodi in (3,4,5,9)
      and me.lectcodi = 1
      and pto.ptomedicodi = {0}
      AND me.MEDIFECHA >= to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')
      AND me.MEDIFECHA &lt;= to_date('{2} 00:00:00','YYYY-MM-DD HH24:MI:SS')
      )
      where r > 4*({3}-1) and r &lt;= 4*{3}
    </query>
  </Sql>  
  
  <Sql>
    <key>TotalHistoricoInterconexion</key>
    <query>
      select count(*) total
      from me_medicion96 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      where
      me.tipoinfocodi in (3,4,5,9)
      and me.lectcodi = 1
      and pto.ptomedicodi = {0}
      AND me.MEDIFECHA >= to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')
      AND me.MEDIFECHA &lt;= to_date('{2} 00:00:00','YYYY-MM-DD HH24:MI:SS')
    </query>
  </Sql>  
  
  <Sql>
    <key>DeleteEnvioInterconexion</key>
    <query>
      delete from me_medicion96 where lectcodi = 1 and MEDIFECHA = to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS')
      and ptomedicodi = 5020
    </query>
  </Sql>
  
  <Sql>
    <key>DeleteEnvioPorEmpresa</key>
    <query>
      delete from me_medicion96 where lectcodi = 1 and extract(year from medifecha) = {0}
      and extract(month from medifecha) = {1} and
      ptomedicodi in (select a.ptomedicodi from me_ptomedicion a
      inner join eq_equipo b on a.equicodi = b.equicodi where b.emprcodi = {2})
    </query>
  </Sql>

  <Sql>
    <key>DeleteEnvioArchivo</key>
    <query>
      delete from me_medicion96 where lectcodi = {0} and medifecha >= to_date('{1}','YYYY-MM-DD') and
      medifecha &lt;= to_date('{2}','YYYY-MM-DD') and ptomedicodi in (
        select distinct hp.ptomedicodi from me_hojaptomed hp
        inner join me_ptomedicion pto on pto.ptomedicodi = hp.ptomedicodi
        where hp.formatcodi = {3} and pto.emprcodi = {4}
      )
    </query>
  </Sql>
  
  <Sql>
    <key>ObtenerConsultaPorTipoGeneracion</key>
    <query>
      select * from (
      select me.*,
      eq.equipadre, eq.equicodi,
      (select case when x.equicodi = 0 then eq.equinomb  when x.equicodi > 0 then x.equinomb end from eq_equipo x where x.equicodi = eq.equipadre) as central,
      eq.equinomb as equinomb, emp.emprcodi, emp.emprnomb,
      (row_number() over (order by me.medifecha asc, emp.emprnomb asc)) as r
      from me_medicion96 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join pr_grupo pg on pto.grupocodi = pg.grupocodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      inner join si_empresa emp on pto.emprcodi = emp.emprcodi
      inner join si_fuenteenergia fe on pg.fenergcodi = fe.fenergcodi
      inner join si_tipogeneracion tg on fe.tgenercodi = tg.tgenercodi
      where
      me.tipoinfocodi = {0}
      and me.lectcodi = 1
      and pto.origlectcodi = 1
      and (emp.emprcodi in ({1}) or '{1}' = '-1')  
      and (
      (pg.tipogrupocodi != 10 and {2} = 1) or
      (pg.tipogrupocodi = 10 and  {2} = 2 ) or
      (pg.tipogrupocodi = 2 and {2} = 3 ) or
      ({2} = 0)
      )
      and (tg.tgenercodi in ({3}) or '{3}' = '-1')
      and (me.medifecha >= to_date('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS') and me.medifecha &lt;= to_date('{5} 23:59:59','YYYY-MM-DD HH24:MI:SS'))
          order by me.medifecha asc, emp.emprnomb asc
      )
      where r >= ((({6}-1) * {7}) + 1) and r &lt; (({6} * {7}) + 1 )
      order by medifecha asc, emprnomb asc
    </query>
  </Sql>
  
  <Sql>
    <key>ObtenerConsultaServicioAuxiliar</key>
    <query>
      select * from (
      select me.*,
      (select equicodi2 from eq_equirel where equicodi1 = eq.equicodi) as equipadre, eq.equicodi,
      (select n.equinomb from eq_equipo n where n.equicodi = (select x.equicodi2 from eq_equirel x where x.equicodi1 = eq.equicodi)) as central,
      eq.equinomb as equinomb, emp.emprcodi,
      emp.emprnomb,
      (row_number() over (order by me.medifecha asc, emp.emprnomb asc)) as r
      from me_medicion96 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      inner join eq_equirel ex on eq.equicodi = ex.equicodi1
      inner join eq_equipo eq1 on ex.equicodi2 = eq1.equicodi
      inner join pr_grupo pg on eq1.grupocodi = pg.grupocodi
      inner join si_empresa emp on pto.emprcodi = emp.emprcodi
      where
      me.tipoinfocodi = {0}
      and pto.equicodi in (select equicodi1 from eq_equirel where tiporelcodi in ({3}) or ('{3}' = '-1' and tiporelcodi in (20,21,22,23)))
      and me.lectcodi = 1
      and pto.origlectcodi = 14
      and (emp.emprcodi in ({1}) or '{1}' = '-1')
      and (
      (pg.tipogrupocodi != 10 and {2} = 1) or
      (pg.tipogrupocodi = 10 and  {2} = 2 ) or
      (pg.tipogrupocodi = 2 and {2} = 3 ) or
      ({2} = 0)
      )
      and (me.medifecha >= to_date('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS') and me.medifecha &lt;= to_date('{5} 23:59:59','YYYY-MM-DD HH24:MI:SS'))
           order by me.medifecha asc, emp.emprnomb asc
      )
      where r >= ((({6}-1) * {7}) + 1) and r &lt; (({6} * {7}) + 1 )
      order by medifecha asc, emprnomb asc
    </query>
  </Sql>

  <Sql>
    <key>ObtenerExportacionConsultaMedidores</key>
    <query>
      select me.*,
      eq.equipadre, eq.equicodi,
      (select case when x.equicodi = 0 then eq.equinomb  when x.equicodi > 0 then x.equinomb end from eq_equipo x where x.equicodi = eq.equipadre) as central,
      eq.equinomb as equinomb, emp.emprcodi, emp.emprnomb
      from me_medicion96 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join pr_grupo pg on pto.grupocodi = pg.grupocodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      inner join si_empresa emp on pto.emprcodi = emp.emprcodi
      inner join si_fuenteenergia fe on pg.fenergcodi = fe.fenergcodi
      inner join si_tipogeneracion tg on fe.tgenercodi = tg.tgenercodi
      where
      me.tipoinfocodi = {0}
      and me.lectcodi = 1
      and pto.origlectcodi = 1
      and (emp.emprcodi in ({1}) or '{1}' = '-1')
      and (
      (pg.tipogrupocodi != 10 and {2} = 1) or
      (pg.tipogrupocodi = 10 and  {2} = 2 ) or
      (pg.tipogrupocodi = 2 and {2} = 3 ) or
      ({2} = 0)
      )
      and (tg.tgenercodi in ({3}) or '{3}' = '-1')
      and (me.medifecha >= to_date('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS') and me.medifecha &lt;= to_date('{5} 23:59:59','YYYY-MM-DD HH24:MI:SS'))
      order by me.medifecha asc, emp.emprnomb asc
    </query>
  </Sql>

  <Sql>
    <key>ObtenerExportacionServiciosAuxiliares</key>
    <query>
      select me.*,
      (select equicodi2 from eq_equirel where equicodi1 = eq.equicodi) as equipadre, eq.equicodi,
      (select n.equinomb from eq_equipo n where n.equicodi = (select x.equicodi2 from eq_equirel x where x.equicodi1 = eq.equicodi)) as central,
      eq.equinomb as equinomb, emp.emprcodi,
      emp.emprnomb
      from me_medicion96 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      inner join eq_equirel ex on eq.equicodi = ex.equicodi1
      inner join eq_equipo eq1 on ex.equicodi2 = eq1.equicodi
      inner join pr_grupo pg on eq1.grupocodi = pg.grupocodi
      inner join si_empresa emp on pto.emprcodi = emp.emprcodi
      where
      me.tipoinfocodi = {0}
      and pto.equicodi in (select equicodi1 from eq_equirel where tiporelcodi in ({3}) or ('{3}' = '-1' and tiporelcodi in (20,21,22,23)))
      and me.lectcodi = 1
      and pto.origlectcodi = 14
      and (emp.emprcodi in ({1}) or '{1}' = '-1')
      and (
      (pg.tipogrupocodi != 10 and {2} = 1) or
      (pg.tipogrupocodi = 10 and  {2} = 2 ) or
      (pg.tipogrupocodi = 2 and {2} = 3 ) or
      ({2} = 0)
      )
      and (me.medifecha >= to_date('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS') and me.medifecha &lt;= to_date('{5} 23:59:59','YYYY-MM-DD HH24:MI:SS'))
      order by me.medifecha asc, emp.emprnomb asc
    </query>
  </Sql>  

  <Sql>
    <key>NroRegistrosConsultasTipoGeneracion</key>
    <query>
      select count(*)
      from me_medicion96 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join pr_grupo pg on pto.grupocodi = pg.grupocodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      inner join si_empresa emp on pto.emprcodi = emp.emprcodi
      inner join si_fuenteenergia fe on pg.fenergcodi = fe.fenergcodi
      inner join si_tipogeneracion tg on fe.tgenercodi = tg.tgenercodi
      where
      me.tipoinfocodi = {0}
      and me.lectcodi = 1
      and pto.origlectcodi = 1
      and (emp.emprcodi in ({1}) or '{1}' = '-1')
      and (
      (pg.tipogrupocodi != 10 and {2} = 1) or
      (pg.tipogrupocodi = 10 and  {2} = 2 ) or
      (pg.tipogrupocodi = 2 and {2} = 3 ) or
      ({2} = 0)
      )
      and (tg.tgenercodi in ({3}) or '{3}' = '-1')
      and (me.medifecha >= to_date('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS') and me.medifecha &lt;= to_date('{5} 23:59:59','YYYY-MM-DD HH24:MI:SS'))

    </query>
  </Sql>

  <Sql>
    <key>NroRegistrosServiciosAuxiliares</key>
    <query>
      select count(*)
      from me_medicion96 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      inner join eq_equirel ex on eq.equicodi = ex.equicodi1
      inner join eq_equipo eq1 on ex.equicodi2 = eq1.equicodi
      inner join pr_grupo pg on eq1.grupocodi = pg.grupocodi
      inner join si_empresa emp on pto.emprcodi = emp.emprcodi
      where
      me.tipoinfocodi = {0}
      and pto.equicodi in (select equicodi1 from eq_equirel where tiporelcodi in ({3}) or ('{3}' = '-1' and tiporelcodi in (20,21,22,23)))
      and me.lectcodi = 1
      and pto.origlectcodi = 14
      and (emp.emprcodi in ({1}) or '{1}' = '-1')
      and (
      (pg.tipogrupocodi != 10 and {2} = 1) or
      (pg.tipogrupocodi = 10 and  {2} = 2 ) or
      (pg.tipogrupocodi = 2 and {2} = 3 ) or
      ({2} = 0)
      )
      and (me.medifecha >= to_date('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS') and me.medifecha &lt;= to_date('{5} 23:59:59','YYYY-MM-DD HH24:MI:SS'))
    </query>
  </Sql>

  <Sql>
    <key>TotalConsultaMedidores</key>
    <query>
      select sum(meditotal) as meditotal,
      sum(h1) as h1, max(h1) as g1, min(h1) as m1,
      sum(h2) as h2, max(h2) as g2, min(h2) as m2,
      sum(h3) as h3, max(h3) as g3, min(h3) as m3,
      sum(h4) as h4, max(h4) as g4, min(h4) as m4,
      sum(h5) as h5, max(h5) as g5, min(h5) as m5,
      sum(h6) as h6, max(h6) as g6, min(h6) as m6,
      sum(h7) as h7, max(h7) as g7, min(h7) as m7,
      sum(h8) as h8, max(h8) as g8, min(h8) as m8,
      sum(h9) as h9, max(h9) as g9, min(h9) as m9,
      sum(h10) as h10, max(h10) as g10, min(h10) as m10,
      sum(h11) as h11, max(h11) as g11, min(h11) as m11,
      sum(h12) as h12, max(h12) as g12, min(h12) as m12,
      sum(h13) as h13, max(h13) as g13, min(h13) as m13,
      sum(h14) as h14, max(h14) as g14, min(h14) as m14,
      sum(h15) as h15, max(h15) as g15, min(h15) as m15,
      sum(h16) as h16, max(h16) as g16, min(h16) as m16,
      sum(h17) as h17, max(h17) as g17, min(h17) as m17,
      sum(h18) as h18, max(h18) as g18, min(h18) as m18,
      sum(h19) as h19, max(h19) as g19, min(h19) as m19,
      sum(h20) as h20, max(h20) as g20, min(h20) as m20,
      sum(h21) as h21, max(h21) as g21, min(h21) as m21,
      sum(h22) as h22, max(h22) as g22, min(h22) as m22,
      sum(h23) as h23, max(h23) as g23, min(h23) as m23,
      sum(h24) as h24, max(h24) as g24, min(h24) as m24,
      sum(h25) as h25, max(h25) as g25, min(h25) as m25,
      sum(h26) as h26, max(h26) as g26, min(h26) as m26,
      sum(h27) as h27, max(h27) as g27, min(h27) as m27,
      sum(h28) as h28, max(h28) as g28, min(h28) as m28,
      sum(h29) as h29, max(h29) as g29, min(h29) as m29,
      sum(h30) as h30, max(h30) as g30, min(h30) as m30,
      sum(h31) as h31, max(h31) as g31, min(h31) as m31,
      sum(h32) as h32, max(h32) as g32, min(h32) as m32,
      sum(h33) as h33, max(h33) as g33, min(h33) as m33,
      sum(h34) as h34, max(h34) as g34, min(h34) as m34,
      sum(h35) as h35, max(h35) as g35, min(h35) as m35,
      sum(h36) as h36, max(h36) as g36, min(h36) as m36,
      sum(h37) as h37, max(h37) as g37, min(h37) as m37,
      sum(h38) as h38, max(h38) as g38, min(h38) as m38,
      sum(h39) as h39, max(h39) as g39, min(h39) as m39,
      sum(h40) as h40, max(h40) as g40, min(h40) as m40,
      sum(h41) as h41, max(h41) as g41, min(h41) as m41,
      sum(h42) as h42, max(h42) as g42, min(h42) as m42,
      sum(h43) as h43, max(h43) as g43, min(h43) as m43,
      sum(h44) as h44, max(h44) as g44, min(h44) as m44,
      sum(h45) as h45, max(h45) as g45, min(h45) as m45,
      sum(h46) as h46, max(h46) as g46, min(h46) as m46,
      sum(h47) as h47, max(h47) as g47, min(h47) as m47,
      sum(h48) as h48, max(h48) as g48, min(h48) as m48,
      sum(h49) as h49, max(h49) as g49, min(h49) as m49,
      sum(h50) as h50, max(h50) as g50, min(h50) as m50,
      sum(h51) as h51, max(h51) as g51, min(h51) as m51,
      sum(h52) as h52, max(h52) as g52, min(h52) as m52,
      sum(h53) as h53, max(h53) as g53, min(h53) as m53,
      sum(h54) as h54, max(h54) as g54, min(h54) as m54,
      sum(h55) as h55, max(h55) as g55, min(h55) as m55,
      sum(h56) as h56, max(h56) as g56, min(h56) as m56,
      sum(h57) as h57, max(h57) as g57, min(h57) as m57,
      sum(h58) as h58, max(h58) as g58, min(h58) as m58,
      sum(h59) as h59, max(h59) as g59, min(h59) as m59,
      sum(h60) as h60, max(h60) as g60, min(h60) as m60,
      sum(h61) as h61, max(h61) as g61, min(h61) as m61,
      sum(h62) as h62, max(h62) as g62, min(h62) as m62,
      sum(h63) as h63, max(h63) as g63, min(h63) as m63,
      sum(h64) as h64, max(h64) as g64, min(h64) as m64,
      sum(h65) as h65, max(h65) as g65, min(h65) as m65,
      sum(h66) as h66, max(h66) as g66, min(h66) as m66,
      sum(h67) as h67, max(h67) as g67, min(h67) as m67,
      sum(h68) as h68, max(h68) as g68, min(h68) as m68,
      sum(h69) as h69, max(h69) as g69, min(h69) as m69,
      sum(h70) as h70, max(h70) as g70, min(h70) as m70,
      sum(h71) as h71, max(h71) as g71, min(h71) as m71,
      sum(h72) as h72, max(h72) as g72, min(h72) as m72,
      sum(h73) as h73, max(h73) as g73, min(h73) as m73,
      sum(h74) as h74, max(h74) as g74, min(h74) as m74,
      sum(h75) as h75, max(h75) as g75, min(h75) as m75,
      sum(h76) as h76, max(h76) as g76, min(h76) as m76,
      sum(h77) as h77, max(h77) as g77, min(h77) as m77,
      sum(h78) as h78, max(h78) as g78, min(h78) as m78,
      sum(h79) as h79, max(h79) as g79, min(h79) as m79,
      sum(h80) as h80, max(h80) as g80, min(h80) as m80,
      sum(h81) as h81, max(h81) as g81, min(h81) as m81,
      sum(h82) as h82, max(h82) as g82, min(h82) as m82,
      sum(h83) as h83, max(h83) as g83, min(h83) as m83,
      sum(h84) as h84, max(h84) as g84, min(h84) as m84,
      sum(h85) as h85, max(h85) as g85, min(h85) as m85,
      sum(h86) as h86, max(h86) as g86, min(h86) as m86,
      sum(h87) as h87, max(h87) as g87, min(h87) as m87,
      sum(h88) as h88, max(h88) as g88, min(h88) as m88,
      sum(h89) as h89, max(h89) as g89, min(h89) as m89,
      sum(h90) as h90, max(h90) as g90, min(h90) as m90,
      sum(h91) as h91, max(h91) as g91, min(h91) as m91,
      sum(h92) as h92, max(h92) as g92, min(h92) as m92,
      sum(h93) as h93, max(h93) as g93, min(h93) as m93,
      sum(h94) as h94, max(h94) as g94, min(h94) as m94,
      sum(h95) as h95, max(h95) as g95, min(h95) as m95,
      sum(h96) as h96, max(h96) as g96, min(h96) as m96
      from me_medicion96 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join pr_grupo pg on pto.grupocodi = pg.grupocodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      inner join si_empresa emp on pto.emprcodi = emp.emprcodi
      inner join si_fuenteenergia fe on pg.fenergcodi = fe.fenergcodi
      inner join si_tipogeneracion tg on fe.tgenercodi = tg.tgenercodi
      where
      me.tipoinfocodi = {0}
      and me.lectcodi = 1
      and pto.origlectcodi = 1
      and (emp.emprcodi in ({1}) or '{1}' = '-1')
      and (
      (pg.tipogrupocodi != 10 and {2} = 1) or
      (pg.tipogrupocodi = 10 and  {2} = 2 ) or
      (pg.tipogrupocodi = 2 and {2} = 3 ) or
      ({2} = 0)
      )
      and (tg.tgenercodi in ({3}) or '{3}' = '-1')
      and (me.medifecha >= to_date('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS') and me.medifecha &lt;= to_date('{5} 23:59:59','YYYY-MM-DD HH24:MI:SS'))

    </query>
  </Sql>

  <Sql>
    <key>TotalServiciosAuxiliares</key>
    <query>
      select sum(meditotal) as meditotal,
      sum(h1) as h1, max(h1) as g1, min(h1) as m1,
      sum(h2) as h2, max(h2) as g2, min(h2) as m2,
      sum(h3) as h3, max(h3) as g3, min(h3) as m3,
      sum(h4) as h4, max(h4) as g4, min(h4) as m4,
      sum(h5) as h5, max(h5) as g5, min(h5) as m5,
      sum(h6) as h6, max(h6) as g6, min(h6) as m6,
      sum(h7) as h7, max(h7) as g7, min(h7) as m7,
      sum(h8) as h8, max(h8) as g8, min(h8) as m8,
      sum(h9) as h9, max(h9) as g9, min(h9) as m9,
      sum(h10) as h10, max(h10) as g10, min(h10) as m10,
      sum(h11) as h11, max(h11) as g11, min(h11) as m11,
      sum(h12) as h12, max(h12) as g12, min(h12) as m12,
      sum(h13) as h13, max(h13) as g13, min(h13) as m13,
      sum(h14) as h14, max(h14) as g14, min(h14) as m14,
      sum(h15) as h15, max(h15) as g15, min(h15) as m15,
      sum(h16) as h16, max(h16) as g16, min(h16) as m16,
      sum(h17) as h17, max(h17) as g17, min(h17) as m17,
      sum(h18) as h18, max(h18) as g18, min(h18) as m18,
      sum(h19) as h19, max(h19) as g19, min(h19) as m19,
      sum(h20) as h20, max(h20) as g20, min(h20) as m20,
      sum(h21) as h21, max(h21) as g21, min(h21) as m21,
      sum(h22) as h22, max(h22) as g22, min(h22) as m22,
      sum(h23) as h23, max(h23) as g23, min(h23) as m23,
      sum(h24) as h24, max(h24) as g24, min(h24) as m24,
      sum(h25) as h25, max(h25) as g25, min(h25) as m25,
      sum(h26) as h26, max(h26) as g26, min(h26) as m26,
      sum(h27) as h27, max(h27) as g27, min(h27) as m27,
      sum(h28) as h28, max(h28) as g28, min(h28) as m28,
      sum(h29) as h29, max(h29) as g29, min(h29) as m29,
      sum(h30) as h30, max(h30) as g30, min(h30) as m30,
      sum(h31) as h31, max(h31) as g31, min(h31) as m31,
      sum(h32) as h32, max(h32) as g32, min(h32) as m32,
      sum(h33) as h33, max(h33) as g33, min(h33) as m33,
      sum(h34) as h34, max(h34) as g34, min(h34) as m34,
      sum(h35) as h35, max(h35) as g35, min(h35) as m35,
      sum(h36) as h36, max(h36) as g36, min(h36) as m36,
      sum(h37) as h37, max(h37) as g37, min(h37) as m37,
      sum(h38) as h38, max(h38) as g38, min(h38) as m38,
      sum(h39) as h39, max(h39) as g39, min(h39) as m39,
      sum(h40) as h40, max(h40) as g40, min(h40) as m40,
      sum(h41) as h41, max(h41) as g41, min(h41) as m41,
      sum(h42) as h42, max(h42) as g42, min(h42) as m42,
      sum(h43) as h43, max(h43) as g43, min(h43) as m43,
      sum(h44) as h44, max(h44) as g44, min(h44) as m44,
      sum(h45) as h45, max(h45) as g45, min(h45) as m45,
      sum(h46) as h46, max(h46) as g46, min(h46) as m46,
      sum(h47) as h47, max(h47) as g47, min(h47) as m47,
      sum(h48) as h48, max(h48) as g48, min(h48) as m48,
      sum(h49) as h49, max(h49) as g49, min(h49) as m49,
      sum(h50) as h50, max(h50) as g50, min(h50) as m50,
      sum(h51) as h51, max(h51) as g51, min(h51) as m51,
      sum(h52) as h52, max(h52) as g52, min(h52) as m52,
      sum(h53) as h53, max(h53) as g53, min(h53) as m53,
      sum(h54) as h54, max(h54) as g54, min(h54) as m54,
      sum(h55) as h55, max(h55) as g55, min(h55) as m55,
      sum(h56) as h56, max(h56) as g56, min(h56) as m56,
      sum(h57) as h57, max(h57) as g57, min(h57) as m57,
      sum(h58) as h58, max(h58) as g58, min(h58) as m58,
      sum(h59) as h59, max(h59) as g59, min(h59) as m59,
      sum(h60) as h60, max(h60) as g60, min(h60) as m60,
      sum(h61) as h61, max(h61) as g61, min(h61) as m61,
      sum(h62) as h62, max(h62) as g62, min(h62) as m62,
      sum(h63) as h63, max(h63) as g63, min(h63) as m63,
      sum(h64) as h64, max(h64) as g64, min(h64) as m64,
      sum(h65) as h65, max(h65) as g65, min(h65) as m65,
      sum(h66) as h66, max(h66) as g66, min(h66) as m66,
      sum(h67) as h67, max(h67) as g67, min(h67) as m67,
      sum(h68) as h68, max(h68) as g68, min(h68) as m68,
      sum(h69) as h69, max(h69) as g69, min(h69) as m69,
      sum(h70) as h70, max(h70) as g70, min(h70) as m70,
      sum(h71) as h71, max(h71) as g71, min(h71) as m71,
      sum(h72) as h72, max(h72) as g72, min(h72) as m72,
      sum(h73) as h73, max(h73) as g73, min(h73) as m73,
      sum(h74) as h74, max(h74) as g74, min(h74) as m74,
      sum(h75) as h75, max(h75) as g75, min(h75) as m75,
      sum(h76) as h76, max(h76) as g76, min(h76) as m76,
      sum(h77) as h77, max(h77) as g77, min(h77) as m77,
      sum(h78) as h78, max(h78) as g78, min(h78) as m78,
      sum(h79) as h79, max(h79) as g79, min(h79) as m79,
      sum(h80) as h80, max(h80) as g80, min(h80) as m80,
      sum(h81) as h81, max(h81) as g81, min(h81) as m81,
      sum(h82) as h82, max(h82) as g82, min(h82) as m82,
      sum(h83) as h83, max(h83) as g83, min(h83) as m83,
      sum(h84) as h84, max(h84) as g84, min(h84) as m84,
      sum(h85) as h85, max(h85) as g85, min(h85) as m85,
      sum(h86) as h86, max(h86) as g86, min(h86) as m86,
      sum(h87) as h87, max(h87) as g87, min(h87) as m87,
      sum(h88) as h88, max(h88) as g88, min(h88) as m88,
      sum(h89) as h89, max(h89) as g89, min(h89) as m89,
      sum(h90) as h90, max(h90) as g90, min(h90) as m90,
      sum(h91) as h91, max(h91) as g91, min(h91) as m91,
      sum(h92) as h92, max(h92) as g92, min(h92) as m92,
      sum(h93) as h93, max(h93) as g93, min(h93) as m93,
      sum(h94) as h94, max(h94) as g94, min(h94) as m94,
      sum(h95) as h95, max(h95) as g95, min(h95) as m95,
      sum(h96) as h96, max(h96) as g96, min(h96) as m96
      from me_medicion96 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      inner join eq_equirel ex on eq.equicodi = ex.equicodi1
      inner join eq_equipo eq1 on ex.equicodi2 = eq1.equicodi
      inner join pr_grupo pg on eq1.grupocodi = pg.grupocodi
      inner join si_empresa emp on pto.emprcodi = emp.emprcodi
      where
      me.tipoinfocodi = {0}
      and pto.equicodi in (select equicodi1 from eq_equirel where tiporelcodi in ({3}) or ('{3}' = '-1' and tiporelcodi in (20,21,22,23)))
      and me.lectcodi = 1
      and pto.origlectcodi = 14
      and (emp.emprcodi in ({1}) or '{1}' = '-1')
      and (
      (pg.tipogrupocodi != 10 and {2} = 1) or
      (pg.tipogrupocodi = 10 and  {2} = 2 ) or
      (pg.tipogrupocodi = 2 and {2} = 3 ) or
      ({2} = 0)
      )
      and (me.medifecha >= to_date('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS') and me.medifecha &lt;= to_date('{5} 23:59:59','YYYY-MM-DD HH24:MI:SS'))
    </query>
  </Sql>


  <Sql>
    <key>ListarTotalH</key>
    <query>
      select lectcodi,tipoinfocodi,ptomedicodi,meditotal,mediestado,medifecha,
      sum(h1) h1, sum(h2) h2, sum(h3) h3, sum(h4) h4, sum(h5) h5, sum(h6) h6, sum(h7) h7, sum(h8) h8,sum(h9) h9, sum(h10) h10, sum(h11) h11, sum(h12) h12,sum(h13) h13, sum(h14) h14, sum(h15) h15, sum(h16) h16,sum(h17) h17, sum(h18) h18, sum(h19) h19, sum(h20) h20,
      sum(h21) h21, sum(h22) h22, sum(h23) h23, sum(h24) h24, sum(h25) h25, sum(h26) h26, sum(h27) h27, sum(h28) h28,sum(h29) h29, sum(h30) h30, sum(h31) h31, sum(h32) h32,sum(h33) h33, sum(h34) h34, sum(h35) h35, sum(h36) h36,sum(h37) h37, sum(h38) h38, sum(h39) h39, sum(h40) h40,
      sum(h41) h41, sum(h42) h42, sum(h43) h43, sum(h44) h44, sum(h45) h45, sum(h46) h46, sum(h47) h47, sum(h48) h48,sum(h49) h49, sum(h50) h50, sum(h51) h51, sum(h52) h52,sum(h53) h53, sum(h54) h54, sum(h55) h55, sum(h56) h56,sum(h57) h57, sum(h58) h58, sum(h59) h59, sum(h60) h60,
      sum(h61) h61, sum(h62) h62, sum(h63) h63, sum(h64) h64, sum(h65) h65, sum(h66) h66, sum(h67) h67, sum(h68) h68,sum(h69) h69, sum(h70) h70, sum(h71) h71, sum(h72) h72,sum(h73) h73, sum(h74) h74, sum(h75) h75, sum(h76) h76,sum(h77) h77, sum(h78) h78, sum(h79) h79, sum(h80) h80,
      sum(h81) h81, sum(h82) h82, sum(h83) h83, sum(h84) h84, sum(h85) h85, sum(h86) h86, sum(h87) h87, sum(h88) h88,sum(h89) h89, sum(h90) h90, sum(h91) h91, sum(h92) h92, sum(h93) h93, sum(h94) h94, sum(h95) h95, sum(h96) h96
      from
      (
      select 0 lectcodi, 0 tipoinfocodi,0 ptomedicodi,0 meditotal ,'A' mediestado,medifecha,
      sum(h1) h1, sum(h2) h2, sum(h3) h3, sum(h4) h4, sum(h5) h5, sum(h6) h6, sum(h7) h7, sum(h8) h8,sum(h9) h9, sum(h10) h10, sum(h11) h11, sum(h12) h12,sum(h13) h13, sum(h14) h14, sum(h15) h15, sum(h16) h16,sum(h17) h17, sum(h18) h18, sum(h19) h19, sum(h20) h20,
      sum(h21) h21, sum(h22) h22, sum(h23) h23, sum(h24) h24, sum(h25) h25, sum(h26) h26, sum(h27) h27, sum(h28) h28,sum(h29) h29, sum(h30) h30, sum(h31) h31, sum(h32) h32,sum(h33) h33, sum(h34) h34, sum(h35) h35, sum(h36) h36,sum(h37) h37, sum(h38) h38, sum(h39) h39, sum(h40) h40,
      sum(h41) h41, sum(h42) h42, sum(h43) h43, sum(h44) h44, sum(h45) h45, sum(h46) h46, sum(h47) h47, sum(h48) h48,sum(h49) h49, sum(h50) h50, sum(h51) h51, sum(h52) h52,sum(h53) h53, sum(h54) h54, sum(h55) h55, sum(h56) h56,sum(h57) h57, sum(h58) h58, sum(h59) h59, sum(h60) h60,
      sum(h61) h61, sum(h62) h62, sum(h63) h63, sum(h64) h64, sum(h65) h65, sum(h66) h66, sum(h67) h67, sum(h68) h68,sum(h69) h69, sum(h70) h70, sum(h71) h71, sum(h72) h72,sum(h73) h73, sum(h74) h74, sum(h75) h75, sum(h76) h76,sum(h77) h77, sum(h78) h78, sum(h79) h79, sum(h80) h80,
      sum(h81) h81, sum(h82) h82, sum(h83) h83, sum(h84) h84, sum(h85) h85, sum(h86) h86, sum(h87) h87, sum(h88) h88,sum(h89) h89, sum(h90) h90, sum(h91) h91, sum(h92) h92, sum(h93) h93, sum(h94) h94, sum(h95) h95, sum(h96) h96
      from
      me_medicion96 m96
      inner join me_ptomedicion pto on pto.ptomedicodi = m96.ptomedicodi
      inner join pr_grupo gr on gr.grupocodi = pto.grupocodi
      inner join si_fuenteenergia fe on fe.fenergcodi = gr.fenergcodi
      inner join si_empresa emp on pto.emprcodi = emp.emprcodi
      inner join si_tipogeneracion tg on fe.tgenercodi = tg.tgenercodi
      where medifecha >= to_date('{0}','YYYY-MM-DD') and to_date('{1}','YYYY-MM-DD') >= medifecha
      and pto.origlectcodi = 1 and m96.tipoinfocodi = 1 and m96.lectcodi = 1
      and (emp.emprcodi in ({2}) or '{2}' = '-1')
      and (
      (gr.tipogrupocodi != 10 and {4} = 1) or
      (gr.tipogrupocodi = 10 and  {4} = 2 ) or
      (gr.tipogrupocodi = 2 and {4} = 3 ) or
      ({4} = 0)
      )
      and (tg.tgenercodi in ({3}) or '{3}' = '-1')
      group by 1,2,3,4,5,medifecha
      UNION
      select 0 lectcodi,0 tipoinfocodi,0 ptomedicodi,0 meditotal ,'A' mediestado,medifecha,
      sum( -1 * 4 * h1) h1, sum( -1 * 4 * h2) h2, sum( -1 * 4 * h3) h3, sum( -1 * 4 * h4) h4,sum( -1 * 4 * h5) h5, sum( -1 * 4 * h6) h6, sum( -1 * 4 * h7) h7, sum( -1 * 4 * h8) h8,
      sum( -1 * 4 * h9) h9, sum( -1 * 4 * h10) h10, sum( -1 * 4 * h11) h11, sum( -1 * 4 * h12) h12,sum( -1 * 4 * h13) h13, sum( -1 * 4 * h14) h14, sum( -1 * 4 * h15) h15, sum( -1 * 4 * h16) h16,
      sum( -1 * 4 * h17) h17, sum( -1 * 4 * h18) h18, sum( -1 * 4 * h19) h19, sum( -1 * 4 * h20) h20,sum( -1 * 4 * h21) h21, sum( -1 * 4 * h22) h22, sum( -1 * 4 * h23) h23, sum( -1 * 4 * h24) h24,
      sum( -1 * 4 * h25) h25, sum( -1 * 4 * h26) h26, sum( -1 * 4 * h27) h27, sum( -1 * 4 * h28) h28,sum( -1 * 4 * h29) h29, sum( -1 * 4 * h30) h30, sum( -1 * 4 * h31) h31, sum( -1 * 4 * h32) h32,
      sum( -1 * 4 * h33) h33, sum( -1 * 4 * h34) h34, sum( -1 * 4 * h35) h35, sum( -1 * 4 * h36) h36,sum( -1 * 4 * h37) h37, sum( -1 * 4 * h38) h38, sum( -1 * 4 * h39) h39, sum( -1 * 4 * h40) h40,
      sum( -1 * 4 * h41) h41, sum( -1 * 4 * h42) h42, sum( -1 * 4 * h43) h43, sum( -1 * 4 * h44) h44,sum( -1 * 4 * h45) h45, sum( -1 * 4 * h46) h46, sum( -1 * 4 * h47) h47, sum( -1 * 4 * h48) h48,
      sum( -1 * 4 * h49) h49, sum( -1 * 4 * h50) h50, sum( -1 * 4 * h51) h51, sum( -1 * 4 * h52) h52,sum( -1 * 4 * h53) h53, sum( -1 * 4 * h54) h54, sum( -1 * 4 * h55) h55, sum( -1 * 4 * h56) h56,
      sum( -1 * 4 * h57) h57, sum( -1 * 4 * h58) h58, sum( -1 * 4 * h59) h59, sum( -1 * 4 * h60) h60,sum( -1 * 4 * h61) h61, sum( -1 * 4 * h62) h62, sum( -1 * 4 * h63) h63, sum( -1 * 4 * h64) h64,
      sum( -1 * 4 * h65) h65, sum( -1 * 4 * h66) h66, sum( -1 * 4 * h67) h67, sum( -1 * 4 * h68) h68,sum( -1 * 4 * h69) h69, sum( -1 * 4 * h70) h70, sum( -1 * 4 * h71) h71, sum( -1 * 4 * h72) h72,
      sum( -1 * 4 * h73) h73, sum( -1 * 4 * h74) h74, sum( -1 * 4 * h75) h75, sum( -1 * 4 * h76) h76,sum( -1 * 4 * h77) h77, sum( -1 * 4 * h78) h78, sum( -1 * 4 * h79) h79, sum( -1 * 4 * h80) h80,
      sum( -1 * 4 * h81) h81, sum( -1 * 4 * h82) h82, sum( -1 * 4 * h83) h83, sum( -1 * 4 * h84) h84,sum( -1 * 4 * h85) h85, sum( -1 * 4 * h86) h86, sum( -1 * 4 * h87) h87, sum( -1 * 4 * h88) h88,
      sum( -1 * 4 * h89) h89, sum( -1 * 4 * h90) h90, sum( -1 * 4 * h91) h91, sum( -1 * 4 * h92) h92,sum( -1 * 4 * h93) h93, sum( -1 * 4 * h94) h94, sum( -1 * 4 * h95) h95, sum( -1 * 4 * h96) h96
      from
      me_medicion96 m96
      where m96.ptomedicodi = 5020 and m96.medifecha >= to_date('{0}','YYYY-MM-DD') and
      to_date('{1}','YYYY-MM-DD') >= m96.medifecha and m96.tipoinfocodi = 3 and
      m96.lectcodi = 1
      group by 1,2,3,4,5,medifecha)
      GROUP BY lectcodi,tipoinfocodi,ptomedicodi,meditotal,mediestado,medifecha
      ORDER BY MEDIFECHA
    </query>
  </Sql>

  <Sql>
    <key>ListarDetalle</key>
    <query>
      select
      em.emprnomb empresa,eqp.equinomb central,eq.equinomb grupo,tg.tgenernomb,
      h96,h95,h94, h93,h92,h91,h90,h89,h88,h87,h86,h85,h84,h83,h82,h81,h80,h79,h78,h77,h76,h75,h74,h73,h72,h71,h70,
      h69,h68,h67,h66,h65,h64,h63,h62,h61,h60,h59,h58,h57,h56,h55,h54,h53,h52,h51,h50,h49,h48,h47,h46,h45,h44,h43,h42,h41,h40,
      h39,h38,h37,h36,h35,h34,h33,h32,h31,h30,h29,h28,h27,h26,h25,h24,h23,h22,h21,h20,h19,h18,h17,h16,h15,h14,h13, h12,h11,h10,
      h9,h8,h7,h6,h5,h4,h3,h2,h1,mediestado,meditotal,m96.ptomedicodi,m96.tipoinfocodi,medifecha medifecha,m96.lectcodi
      from
      me_medicion96 m96
      inner join me_ptomedicion pto on pto.ptomedicodi = m96.ptomedicodi
      inner join eq_equipo eq on eq.equicodi = pto.equicodi
      inner join eq_equipo eqp on eqp.equicodi = eq.equipadre
      inner join si_empresa em on em.emprcodi = eq.emprcodi
      inner join pr_grupo gr on gr.grupocodi = eq.grupocodi
      inner join si_fuenteenergia fe on fe.fenergcodi = gr.fenergcodi
      inner join si_tipogeneracion tg on tg.tgenercodi = fe.tgenercodi
      where m96.medifecha >= to_date('{0}','YYYY-MM-DD')
      and  to_date('{1}','YYYY-MM-DD') >= m96.medifecha
      and pto.origlectcodi = 1 and m96.tipoinfocodi = 1 and m96.lectcodi = 1
      and (em.emprcodi in ({2}) or '{2}' = '-1')
      and (
      (gr.tipogrupocodi != 10 and {4} = 1) or
      (gr.tipogrupocodi = 10 and  {4} = 2 ) or
      (gr.tipogrupocodi = 2 and {4} = 3 ) or
      ({4} = 0)
      )
      and (tg.tgenercodi in ({3}) or '{3}' = '-1')

      union
      select
      '' empresa,'' central,'' grupo,'' tgenernomb,
      h96,h95,h94, h93,h92,h91,h90,h89,h88,h87,h86,h85,h84,h83,h82,h81,h80,h79,h78,h77,h76,h75,h74,h73,h72,h71,h70,
      h69,h68,h67,h66,h65,h64,h63,h62,h61,h60,h59,h58,h57,h56,h55,h54,h53,h52,h51,h50,h49,h48,h47,h46,h45,h44,h43,h42,h41,h40,
      h39,h38,h37,h36,h35,h34,h33,h32,h31,h30,h29,h28,h27,h26,h25,h24,h23,h22,h21,h20,h19,h18,h17,h16,h15,h14,h13, h12,h11,h10,
      h9,h8,h7,h6,h5,h4,h3,h2,h1,mediestado,meditotal,m96.ptomedicodi,m96.tipoinfocodi,medifecha medifecha,m96.lectcodi
      from
      me_medicion96 m96
      where m96.medifecha >= to_date('{0}','YYYY-MM-DD')
      and  to_date('{1}','YYYY-MM-DD') >= m96.medifecha
      and  m96.tipoinfocodi = 3 and m96.lectcodi = 1
      and m96.ptomedicodi = 5020
      order by
      empresa,central,grupo,medifecha
    </query>
  </Sql>

  <Sql>
    <key>ObtenerExportacionMasivaMedidores</key>
    <query>
      select me.*, pto.ptomedielenomb, emp.emprnomb
      from me_medicion96 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join pr_grupo pg on pto.grupocodi = pg.grupocodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      inner join si_empresa emp on eq.emprcodi = emp.emprcodi
      inner join si_fuenteenergia fe on pg.fenergcodi = fe.fenergcodi
      inner join si_tipogeneracion tg on fe.tgenercodi = tg.tgenercodi
      where
      me.tipoinfocodi = {0}
      and me.lectcodi = 1
      and pto.origlectcodi = 1
      and (pto.emprcodi in ({1}) or '{1}' = '-1')
      and (
      (pg.tipogrupocodi != 10 and {2} = 1) or
      (pg.tipogrupocodi = 10 and  {2} = 2 ) or
      (pg.tipogrupocodi = 2 and {2} = 3 ) or
      ({2} = 0)
      )
      and (tg.tgenercodi in ({3}) or '{3}' = '-1')
      and (me.medifecha >= to_date('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS') and me.medifecha &lt;= to_date('{5} 23:59:59','YYYY-MM-DD HH24:MI:SS'))
      order by me.medifecha asc
    </query>
  </Sql>

  <Sql>
    <key>ObtenerExportacionMasivaSSAA</key>
    <query>
      select me.*, pto.ptomedielenomb, emp.emprnomb
      from me_medicion96 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      inner join eq_equirel ex on eq.equicodi = ex.equicodi1
      inner join eq_equipo eq1 on ex.equicodi2 = eq1.equicodi
      inner join pr_grupo pg on eq1.grupocodi = pg.grupocodi
      inner join si_empresa emp on pto.emprcodi = emp.emprcodi
      where
      me.tipoinfocodi = {0}
      and pto.equicodi in (select equicodi1 from eq_equirel where tiporelcodi in ({3}) or ('{3}' = '-1' and tiporelcodi in (20,21,22,23)))
      and me.lectcodi = 1
      and pto.origlectcodi = 14
      and (pto.emprcodi in ({1}) or '{1}' = '-1')
      and (
      (pg.tipogrupocodi != 10 and {2} = 1) or
      (pg.tipogrupocodi = 10 and  {2} = 2 ) or
      (pg.tipogrupocodi = 2 and {2} = 3 ) or
      ({2} = 0)
      )
      and (me.medifecha >= to_date('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS') and me.medifecha &lt;= to_date('{5} 23:59:59','YYYY-MM-DD HH24:MI:SS'))
      order by me.medifecha asc
    </query>
  </Sql>

  <Sql>
    <key>ObtenerReporteMedidores</key>
    <query>
      select me.*,
      eq.equipadre, eq.equicodi,
      (select case when x.equicodi = 0 then eq.equinomb  when x.equicodi > 0 then x.equinomb end from eq_equipo x where x.equicodi = eq.equipadre) as central,
      eq.equinomb as equinomb, emp.emprcodi, emp.emprnomb,
      fe.fenergcodi, fe.fenergnomb, fe.fenergabrev, tg.tgenernomb, tg.tgenercodi
      from me_medicion96 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join pr_grupo pg on pto.grupocodi = pg.grupocodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      inner join si_empresa emp on pto.emprcodi = emp.emprcodi
      inner join si_fuenteenergia fe on pg.fenergcodi = fe.fenergcodi
      inner join si_tipogeneracion tg on fe.tgenercodi = tg.tgenercodi
      where
      me.tipoinfocodi = 1
      and me.lectcodi = 1
      and pto.origlectcodi = 1
      and (emp.emprcodi in ({0}) or '{0}' = '-1')
      and (
      (pg.tipogrupocodi != 10 and {1} = 1) or
      (pg.tipogrupocodi = 10 and  {1} = 2 ) or
      (pg.tipogrupocodi = 2 and {1} = 3 ) or
      ({1} = 0)
      )
      and (fe.fenergcodi in ({2}) or '{2}' = '-1')
      and (me.medifecha >= to_date('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')
      and me.medifecha &lt;= to_date('{4} 23:59:59','YYYY-MM-DD HH24:MI:SS'))
      order by me.medifecha asc
    </query>
  </Sql>

  <Sql>
    <key>ObtenerDatosReporteMD</key>
    <query>
      select
      0 lectcodi,
      0 Tipoinfocodi,
      0 Ptomedicodi,
      0 Meditotal ,
      'A' Mediestado,
      medifecha,
      sum(h1) h1, sum(h2) h2, sum(h3) h3, sum(h4) h4,
      sum(h5) h5, sum(h6) h6, sum(h7) h7, sum(h8) h8,
      sum(h9) h9, sum(h10) h10, sum(h11) h11, sum(h12) h12,
      sum(h13) h13, sum(h14) h14, sum(h15) h15, sum(h16) h16,
      sum(h17) h17, sum(h18) h18, sum(h19) h19, sum(h20) h20,
      sum(h21) h21, sum(h22) h22, sum(h23) h23, sum(h24) h24,
      sum(h25) h25, sum(h26) h26, sum(h27) h27, sum(h28) h28,
      sum(h29) h29, sum(h30) h30, sum(h31) h31, sum(h32) h32,
      sum(h33) h33, sum(h34) h34, sum(h35) h35, sum(h36) h36,
      sum(h37) h37, sum(h38) h38, sum(h39) h39, sum(h40) h40,
      sum(h41) h41, sum(h42) h42, sum(h43) h43, sum(h44) h44,
      sum(h45) h45, sum(h46) h46, sum(h47) h47, sum(h48) h48,
      sum(h49) h49, sum(h50) h50, sum(h51) h51, sum(h52) h52,
      sum(h53) h53, sum(h54) h54, sum(h55) h55, sum(h56) h56,
      sum(h57) h57, sum(h58) h58, sum(h59) h59, sum(h60) h60,
      sum(h61) h61, sum(h62) h62, sum(h63) h63, sum(h64) h64,
      sum(h65) h65, sum(h66) h66, sum(h67) h67, sum(h68) h68,
      sum(h69) h69, sum(h70) h70, sum(h71) h71, sum(h72) h72,
      sum(h73) h73, sum(h74) h74, sum(h75) h75, sum(h76) h76,
      sum(h77) h77, sum(h78) h78, sum(h79) h79, sum(h80) h80,
      sum(h81) h81, sum(h82) h82, sum(h83) h83, sum(h84) h84,
      sum(h85) h85, sum(h86) h86, sum(h87) h87, sum(h88) h88,
      sum(h89) h89, sum(h90) h90, sum(h91) h91, sum(h92) h92,
      sum(h93) h93, sum(h94) h94, sum(h95) h95, sum(h96) h96
      from me_medicion96 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join pr_grupo pg on pto.grupocodi = pg.grupocodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      inner join si_empresa emp on pto.emprcodi = emp.emprcodi
      inner join si_fuenteenergia fe on pg.fenergcodi = fe.fenergcodi
      inner join si_tipogeneracion tg on fe.tgenercodi = tg.tgenercodi
      where
      me.tipoinfocodi = 1
      and me.lectcodi = 1
      and pto.origlectcodi = 1
      and (emp.emprcodi in ({0}) or '{0}' = '-1')
      and (
      (pg.tipogrupocodi != 10 and {1} = 1) or
      (pg.tipogrupocodi = 10 and  {1} = 2 ) or
      (pg.tipogrupocodi = 2 and {1} = 3 ) or
      ({1} = 0)
      )
      and (fe.fenergcodi in ({2}) or '{2}' = '-1')
      and (me.medifecha >= to_date('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')
      and me.medifecha &lt;= to_date('{4} 23:59:59','YYYY-MM-DD HH24:MI:SS'))
      group by 1,2,3,4,5,medifecha
    </query>
  </Sql>

  <Sql>
    <key>ConsolidadoEnvioEmpresa</key>
    <query>
      select d.equicodi idCentral,d.equinomb central,c.equinomb GrupSSAA,g.tgenercodi tipoGeneracion,sum(a.meditotal)/4 total
      from me_medicion96 a,me_ptomedicion b, eq_equipo c, eq_equipo d,pr_grupo e,SI_FUENTEENERGIA f,SI_TIPOGENERACION g
      where  a.lectcodi = 1 and a.tipoinfocodi = 1 and
      a.ptomedicodi = b.ptomedicodi and b.origlectcodi = 1 and  b.equicodi = c.equicodi and
      c.equipadre = d.equicodi and c.grupocodi = e.grupocodi and e.fenergcodi = f.fenergcodi and f.tgenercodi = g.tgenercodi
      and c.emprcodi = {0} and  extract(year from a.medifecha) = {1} and
      extract(month from a.medifecha) = {2} group by d.equicodi,d.equinomb,c.equinomb,g.tgenercodi
      union
      select e.equicodi,e.equinomb,c.equinomb,d.TIPORELCODI,sum(a.meditotal)/4 total
      from me_medicion96 a,me_ptomedicion b, eq_equipo c, EQ_EQUIREL d,eq_equipo e
      where  a.lectcodi = 1 and a.tipoinfocodi = 1 and
      a.ptomedicodi = b.ptomedicodi and b.origlectcodi = 14 and  b.equicodi = c.equicodi and
      c.equicodi = d.equicodi1 and d.equicodi2 = e.equicodi and c.emprcodi = {0} and
      extract(year from a.medifecha) = {1} and
      extract(month from a.medifecha) =  {2} group by e.equicodi,e.equinomb,c.equinomb,d.TIPORELCODI

    </query>
  </Sql>

  <Sql>
    <key>GetEnvioArchivo</key>
    <query>
      select me.* from me_medicion96 me
      inner join me_hojaptomed hp on hp.ptomedicodi = me.ptomedicodi and hp.tipoinfocodi = me.tipoinfocodi
      inner join me_formatohoja fh on fh.formatcodi = hp.formatcodi
      inner join me_ptomedicion pto on pto.ptomedicodi = hp.ptomedicodi
      where hp.formatcodi = {0} and pto.emprcodi = {1} and medifecha >= to_date('{2}','YYYY-MM-DD') AND
      medifecha &lt;= to_date('{3}','YYYY-MM-DD')
      order by hp.hojaptoorden asc
    </query>
  </Sql>

  <Sql>
    <key>GetHidrologia</key>
    <query>
      select
      m96.*, tpto.tipoptomedinomb,eq.equinomb,ti.tipoinfoabrev
      from
      me_medicion96 m96
      inner join me_ptomedicion pto on pto.ptomedicodi = m96.ptomedicodi
      inner join eq_equipo eq on eq.equicodi = pto.equicodi
      inner join me_tipoptomedicion tpto on tpto.tipoptomedicodi = pto.tipoptomedicodi
      inner join si_tipoinformacion ti on ti.tipoinfocodi = m96.tipoinfocodi
      inner join si_empresa empr on empr.emprcodi = eq.emprcodi
      where m96.lectcodi = {0} and pto.origlectcodi = {1} and
      (empr.emprcodi in ({2}) or '{2}' = '-1') and
      m96.medifecha >= to_date('{3}','YYYY-MM-DD') AND
      m96.medifecha &lt;= to_date('{4}','YYYY-MM-DD')
    </query>
  </Sql>
</Sqls>
